# TODOs

## Этапы разработки

### ЭТАП 1 - Минимально жизнеспособный продукт (MVP)


- [x] Список матрицы компетенций в виде сетки и списка
- [x] Раздел "обо мне"
- [x] Возможность связаться со мной
- [x] Блог (без АПИ, только core-функционал)
- [x] Админка на SQLAdmin

- [x] Убрать password_hash из доменной модели User
- [x] Убрать информацию о менторстве. Раздел "обо мне" оставить.
- [ ] Поменять nginx на traefik
- [ ] (SEO) Добавить ссылку canonical
- [x] Провалидировать css (сделать упор на override переменных bootstrap)
- [x] Перенести bootstrap (и все остальные файлы, по необходимости) в папку со статикой
- [ ] Переделать админку на litestar
  - [x] Вычистить SQLAdmin
    - [x] Удалить запуск админки (docker, create_admin + Makefile)
    - [x] Перенести /presign-put в litestar ручку.
    - [x] Перенести apply_template_callables в litestar
    - [x] Убрать ненужные настройки из litestar (админка, auth)
    - [x] Убрать использование админки в коде
    - [x] Убрать зависимости от sqladmin из uv
  - [ ] Редактирование матрицы компетенций прямо на сайте
    - [x] (BACK) Фильтр опубликованности вопросов матрицы компетенций (только для админа)
    - [ ] (FRONT) Тумблер переключения режима вывода списка вопросов: только опубликованные и все
    - [x] (BACK) Расширенный ответ по деталке вопроса матрицы компетенций (дополнительно статус вопроса)
    - [ ] (BACK) CRUD для вопросов матрицы компетенций (включая вложенные сущности)
    - [ ] (BACK) guard на CRUD
    - [x] (BACK) guard на /api/files/presign-put
    - [ ] (FRONT) Режим редактирования конкретного вопроса (кнопка и форма на деталке вопроса)
    - [ ] (FRONT) Кнопка удаления вопроса на деталке вопроса
    - [ ] (FRONT) Кнопка и форма добавления вопроса в нужном разделе матрицы компетенций
    - [ ] (FRONT) Кнопка Опубликовать/снять с публикации (в зависимости от статуса)
  - [x] базовая авторизация и проверка прав на редактирование (PASETO без сессии. Сессия потом)
    - [x] (FRONT) Страница логина с кнопкой логина на главной (пока скрыть)
    - [x] (BACK) логика логина
    - [x] (FRONT) кнопка логаута на главной (пока скрыть)
    - [x] (BACK) логика логаута (ничего не делает)
    - [x] (BACK) guard на проверку авторизации (пока только админы могут войти)
    - [x] (BACK) Сделать анонимного пользователя
  - [ ] Провести смоук-тест
    - [ ] ToastUI должен работать, как и прежде: загрузка файлов через /presign-put, отображение
      загруженных файлов, редактирование контента, сохранение контента.
    - [ ] Поиск по матрице компетенций должен работать, как и прежде: поиск, layout.
    - [ ] Модалка вопроса матрицы компетенций должна открываться, блоки с кодом должны форматироваться

### ЭТАП 1.5 - Улучшения MVP, доработка текущего функционала

- [ ] Соглашение на использование cookies.
- [ ] Проверить оптимизацию сайта
  - [ ] Сделать нагрузочное тестирование (locust)
  - [ ] Проверить сайт через Lighthouse. Поправить ошибки и улучшить показатели
  - [ ] (SEO) Добавить ссылку schemaMarkup
- [ ] Сделать закрытое тестирование MVP с реальными пользователями (друзья, коллеги). Собрать фидбек и
  исправить критичные баги.
- [ ] Добавить базовую аналитику (Matomo) для отслеживания поведения пользователей на сайте.
- [ ] Оптимизировать время загрузки страниц (минификация CSS и JS, оптимизация изображений).
      Возможно, нужно вынести статику на CDN.
- [ ] Перенести матрицу компетенций из Google Docs в базу данных.
- [ ] Аудит безопасности MVP. Проверить на уязвимости и исправить найденные проблемы. Найти checklist по
  безопасности веб-приложений и пройтись по нему.

### ЭТАП 2 - Frontend

- [ ] Перейти на полноценный frontend-framework (angular, скорее всего)
- [ ] Поправить поиск вопросов на фронте: нужно, чтобы удалялись также пустые разделы
- [ ] Сделать текст выделения на сайте в цвет темы.

### ЭТАП 3 - Блог и Flashcards

- [ ] Создание карточек из матрицы компетенций (stateless - без сохранения, перезапуск = новый набор
  карточек)
- [ ] Создание самописных карточек
- [ ] экспорт карточек пользователя в .apkg формат

- [ ] Вывод постов по дате публикации
- [ ] Фильтры постов по тэгам и дате
- [ ] Поиск постов по названию и контенту
- [ ] Реакции на посты

### ЭТАП 4 - Доработка матрицы и Курсы

- [ ] Добавить отдельный список-очередь для вопросов, которые я хочу добавить в матрицу компетенций
- [ ] Создание шага материала курса (может включать видео, текст, картинки, файлы, тесты)
- [ ] playground для тестов курса
- [ ] Создание курсов, включающих в себя шаги материала курса
- [ ] Привязка курсов к матрице компетенций
- [ ] Просмотр доступных курсов
- [ ] Возможность предложить свой вопрос для матрицы компетенций
- [ ] Возможность отправить информацию об опечатке в матрице компетенций

### ЭТАП 5 - Пользователи

- [ ] Доработка аутентификация пользователей (возможно, через OAuth2)
  - [ ] (FRONT) Кнопка и форма регистрации
  - [ ] (BACK) Логика регистрации
  - [ ] (FRONT) Кнопка и форма восстановления пароля (Просто подтверждение с отправкой на почту)
  - [ ] (BACK) Логика восстановления пароля
  - [ ] (BACK) добавление cookie сессии (при логине/регистрации и удаление при логауте)
- [ ] Политика конфидекиальности
- [ ] пользовательское соглашение
- [ ] Согласие на обработку персональных данных
- [ ] Восстановление пароля
- [ ] Подтверждение пароля
- [ ] Создание карточек из матрицы компетенций (stateful - сохранение на пользователя)
- [ ] Возможность оставить комментарии к постам в блоге
- [ ] 2FA/MFA для пользователей
- [ ] Профиль пользователя
  - [ ] статистика прохождения курсов
  - [ ] изменение личных данных
  - [ ] настройки уведомлений
  - [ ] просмотр сохранённых карточек flashcards
  - [ ] Список устройств, с которых был выполнен вход в аккаунт

### ЭТАП 6 - Трасировки и мониторинг

- [ ] Алерты об ошибках в телеграм-бота
- [ ] Подключить Grafana + Prometheus + Loki
- [ ] Подключить сервис мониторинга состояния контейнеров
  - [ ] Слать уведомления при падении контейнеров
  - [ ] Слать уведомления при высоком использовании ресурсов (CPU, RAM)

### ЭТАП 7 - Инфраструктура и Локализация

- [ ] Добавить локализацию в базе данных (возможно, нужна отдельная база под локализации)
- [ ] Добавить Databasus для бэкапа базы данных
- [ ] Добавить выбор локализации на фронте
- [ ] VPN для доступа к внутренним системам
- [ ] Подключить dependabot'а к репозиторию
- [ ] Нужно защитить сайт от ботов
- [ ] Вынести миграцию из app_lifespan в отдельную таску (можно в docker-compose)
- [ ] Заменить uvicorn на granian
- [ ] Когда выйдет 3.14, нужно добавить интроспекцию асинхронного лага
  [отсуда](https://docs.python.org/3.14/whatsnew/3.14.html#asyncio-introspection-capabilities)

### ЭТАП 8 - Безопасность

- [ ] Dependency scanning (Safety, Bandit)
- [ ] OWASP Top 10 compliance check
- [ ] Возможно, есть AI-агент для поиска уязвимостей в приложении

## Рефакторинг

- [ ] Упростить BootstrapRenderer
- [ ] Добавить pre-commit hooks (ruff, mypy, pytest)
- [ ] Вынести cli в отдельную точку запуска (из main.py)

## Документация

- [ ] ADR по написанию кода (code quality)

## Ошибки

...