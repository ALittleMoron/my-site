# Доменные сущности

Документация описывает доменные сущности личного сайта-портфолио, их назначение, взаимодействие и сценарии использования. Создана для фиксации структуры доменного слоя и обеспечения единообразного понимания архитектуры.

## Общие принципы

**Архитектурные принципы:**
- **Богатая доменная модель** — бизнес-логика инкапсулирована в методах сущностей
- **Неизменяемость** — все сущности создаются как неизменяемые объекты
- **Типизация** — строгая типизация всех атрибутов
- **Валидация** — бизнес-правила проверяются в методах сущностей

**Базовые концепции:**
- **Секретные данные** — специальная обертка для чувствительных данных (пароли, токены)
- **Контейнеры значений** — обертки для списков значений с методами итерации
- **Перечисления с метками** — перечисления со строковыми значениями и человекочитаемыми метками

## Доменные сущности

### 1. Пользователи

**Назначение:** Управление пользователями системы, их ролями и правами доступа.

**Основная сущность — Пользователь:**
- Имя пользователя (уникальное)
- Пароль (защищенное хранение)
- Роль в системе

**Роли пользователей:**
- Обычный пользователь — может просматривать публичный контент
- Администратор — может управлять всем контентом системы

**Бизнес-логика:**
- Проверка прав администратора
- Проверка статуса обычного пользователя
- Безопасное хранение паролей

**Сценарии использования:**
- Аутентификация пользователей
- Проверка прав доступа к админ-панели
- Управление ролями пользователей

### 2. Блог

**Назначение:** Управление статьями блога, их публикацией и отображением.

**Основные сущности:**

**Статья блога:**
- Уникальный идентификатор
- Заголовок статьи
- Содержимое статьи
- Уникальный URL-адрес (slug)
- Дата публикации (может быть пустой)
- Статус публикации
- Даты создания и обновления

**Список статей:**
- Общее количество статей
- Общее количество страниц
- Список статей

**Статусы публикации:**
- Черновик — статья не отображается публично
- Опубликовано — статья доступна всем посетителям

**Бизнес-логика:**
- Проверка доступности статьи для публичного просмотра
- Управление статусом публикации
- Поддержка SEO-дружественных URL

**Сценарии использования:**
- Создание и редактирование статей
- Публикация черновиков
- Отображение списка статей с пагинацией
- Просмотр отдельной статьи

### 3. Контакты

**Назначение:** Обработка сообщений от посетителей сайта.

**Основная сущность — Сообщение:**
- Уникальный идентификатор
- IP-адрес отправителя
- Имя отправителя (опционально)
- Email отправителя (опционально)
- Telegram отправителя (опционально)
- Текст сообщения (обязательно)

**Бизнес-логика:**
- Сохранение IP-адреса для безопасности
- Опциональные контактные данные
- Обязательное сообщение

**Сценарии использования:**
- Отправка формы обратной связи
- Обработка сообщений от посетителей
- Администрирование входящих сообщений

### 4. Матрица компетенций

**Назначение:** Интерактивная система вопросов и ответов для демонстрации технических навыков.

**Основные сущности:**

**Элемент матрицы компетенций:**
- Уникальный идентификатор
- Вопрос
- Статус публикации
- Ответ на вопрос
- Ожидаемый ответ на собеседовании
- Название листа компетенций
- Уровень сложности
- Секция
- Подсекция
- Список внешних ресурсов

**Внешний ресурс:**
- Уникальный идентификатор
- Название ресурса
- Ссылка на ресурс
- Контекст использования

**Контейнеры данных:**
- Список листов компетенций
- Список подсекций
- Список внешних ресурсов
- Список элементов матрицы

**Уровни сложности:**
- Начальный уровень
- Начальный+ уровень
- Средний уровень
- Средний+ уровень
- Старший уровень

**Бизнес-логика:**
- Проверка доступности вопроса для публичного просмотра
- Фильтрация только доступных вопросов
- Иерархическая структура: Лист → Секция → Подсекция
- Связь с внешними ресурсами для дополнительной информации

**Сценарии использования:**
- Отображение списка доступных листов компетенций
- Фильтрация вопросов по листу, секции, подсекции
- Просмотр отдельного вопроса с ресурсами
- Администрирование вопросов и ответов
- Демонстрация технических навыков потенциальным работодателям

## Взаимодействие доменов

### Связи между сущностями

**1. Пользователи ↔ Блог:**
- Пользователи с ролью администратора могут создавать и публиковать статьи
- Обычные пользователи могут только просматривать опубликованные статьи
- Связь через проверку роли в бизнес-логике

**2. Пользователи ↔ Контакты:**
- Администраторы получают уведомления о новых сообщениях
- IP-адрес сохраняется для безопасности и модерации
- Связь через систему ролей

**3. Пользователи ↔ Матрица компетенций:**
- Администраторы управляют вопросами и ответами
- Все пользователи могут просматривать доступные вопросы
- Связь через проверку прав доступа

### Общие принципы взаимодействия

**1. Разделение ответственности:**
- Каждый домен отвечает за свою бизнес-логику
- Взаимодействие происходит через бизнес-процессы
- Нет прямых связей между доменными сущностями

**2. Управление состоянием:**
- Все сущности неизменяемы
- Изменения создают новые экземпляры
- Состояние управляется через слои данных

**3. Безопасность:**
- Чувствительные данные защищены специальными обертками
- Проверка прав доступа на уровне бизнес-логики
- Валидация данных на уровне доменных сущностей

## Сценарии использования

### 1. Публичный доступ

**Просмотр блога:**
1. Получение списка опубликованных статей
2. Фильтрация по статусу "Опубликовано"
3. Отображение с пагинацией

**Матрица компетенций:**
1. Получение списка доступных листов
2. Фильтрация вопросов по критериям
3. Отображение только доступных вопросов

**Отправка сообщения:**
1. Валидация формы обратной связи
2. Сохранение с IP-адресом
3. Уведомление администратора

### 2. Административный доступ

**Управление блогом:**
1. Создание и редактирование статей
2. Управление статусом публикации
3. Просмотр всех статей (включая черновики)

**Управление матрицей:**
1. Создание и редактирование вопросов
2. Управление ресурсами
3. Настройка иерархии (листы, секции, подсекции)

**Управление контактами:**
1. Просмотр входящих сообщений
2. Модерация контента
3. Анализ активности пользователей

### 3. Системные сценарии

**Аутентификация:**
1. Проверка учетных данных
2. Определение роли пользователя
3. Управление сессиями

**Авторизация:**
1. Проверка прав доступа
2. Фильтрация контента по ролям
3. Аудит действий пользователей

## Принципы проектирования

### 1. Богатая доменная модель

**Бизнес-логика в сущностях:**
- Методы проверки состояния (доступность, права)
- Валидация бизнес-правил
- Инкапсуляция доменной логики

### 2. Неизменяемость

**Неизменяемые объекты:**
- Все сущности создаются как неизменяемые
- Изменения создают новые экземпляры
- Гарантия целостности данных

### 3. Типизация

**Строгая типизация:**
- Все атрибуты имеют четкие типы
- Использование объединенных типов для опциональных полей
- Обобщенные типы для переиспользуемых компонентов

### 4. Безопасность

**Защита чувствительных данных:**
- Специальные обертки для паролей и токенов
- Скрытие данных в логах и представлениях

## Расширение доменов

### Добавление новой сущности

**1. Определение схемы:**
- Уникальный идентификатор
- Основные атрибуты
- Бизнес-логика в методах

**2. Создание интерфейса данных:**
- Абстракция для работы с данными
- Методы создания, обновления, удаления

**3. Создание бизнес-процессов:**
- Логика создания сущности
- Валидация и бизнес-правила

### Добавление нового домена

**1. Структура домена:**
- Схемы доменных моделей
- Бизнес-процессы
- Абстракции для работы с данными
- Доменные исключения
- Доменные перечисления (при необходимости)

**2. Регистрация в системе:**
- Подключение к контейнеру зависимостей
- Настройка провайдеров

## Итог

Доменные сущности проекта организованы по принципам Domain-Driven Design и Clean Architecture с четким разделением ответственности, богатой доменной моделью, неизменяемыми сущностями и строгой типизацией.