---
alwaysApply: true
---

# Dependency Injection

- Scope правила:
  - Scope.APP для синглтонов (клиенты, конфигурация, утилиты)
  - Scope.REQUEST для объектов на запрос (Use Cases, Storage, сессии БД)
- Автоматическое разрешение зависимостей: Не создавайте объекты вручную, используйте DI контейнер для инжекции (исключение: тесты самой сущности и места, где нельзя получить зависимость)
- FromDishka в контроллерах: В Litestar endpoints используйте FromDishka[AbstractUseCase] для автоматической инжекции.
- В админке получаем IOC-контейнер Dishka через request.state.dishka_container, если объект Request доступен
- Mock провайдеры в тестах: Создавайте отдельные провайдеры в tests/mocks/providers/ для тестирования.